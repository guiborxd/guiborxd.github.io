<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leitura da Bíblia | Farol da Fé</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; }
        h1, h2, h3 { font-family: 'Lora', serif; }
        .versiculo-numero {
            font-weight: bold;
            color: #a16207; /* Cor âmbar escura */
            float: left;
            margin-right: 8px;
            font-size: 0.8em;
            line-height: 1.5;
        }
    </style>
</head>
<body class="bg-amber-50 text-stone-800">

    <!-- Cabeçalho e Navegação -->
    <header class="bg-stone-800 text-white shadow-lg">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold font-family-lora">Farol da Fé</a>
            <div class="space-x-4">
                <a href="index.html" class="hover:text-amber-300 transition-colors">Início</a>
                <a href="livros.html" class="hover:text-amber-300 transition-colors">Livros da Bíblia</a>
            </div>
        </nav>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container mx-auto px-6 py-12">
        <div id="loading" class="text-center text-xl"><p>Carregando conteúdo...</p></div>

        <div id="conteudo-leitura" class="hidden">
            <h1 id="nome-livro" class="text-4xl font-bold text-center text-stone-800 mb-4"></h1>
            <h2 id="capitulo-selecionado" class="text-2xl text-center text-stone-600 mb-8"></h2>

            <!-- Seletor de Capítulos -->
            <div class="mb-8 text-center">
                <label for="seletor-capitulos" class="mr-2">Escolha um capítulo:</label>
                <select id="seletor-capitulos" class="p-2 rounded-md border-2 border-stone-300"></select>
            </div>

            <!-- Container dos Versículos -->
            <div id="versiculos-container" class="bg-white p-6 md:p-8 rounded-lg shadow-md text-lg leading-relaxed">
                <!-- Versículos serão inseridos aqui -->
            </div>
        </div>
    </main>

    <!-- Rodapé -->
    <footer class="bg-stone-800 text-white text-center p-6 mt-12">
        <p>&copy; 2025 Farol da Fé. Todos os direitos reservados.</p>
    </footer>

    <!-- O SCRIPT COMEÇA AQUI -->
    <script>
        // Lista de metadados dos livros (nome, abreviação, capítulos)
        const todosOsLivros = [
            {"abbrev":"gn","name":"Gênesis","chapters":50}, {"abbrev":"ex","name":"Êxodo","chapters":40},
            {"abbrev":"lv","name":"Levítico","chapters":27}, {"abbrev":"nm","name":"Números","chapters":36},
            {"abbrev":"dt","name":"Deuteronômio","chapters":34}, {"abbrev":"js","name":"Josué","chapters":24},
            {"abbrev":"jz","name":"Juízes","chapters":21}, {"abbrev":"rt","name":"Rute","chapters":4},
            {"abbrev":"1sm","name":"1º Samuel","chapters":31}, {"abbrev":"2sm","name":"2º Samuel","chapters":24},
            {"abbrev":"1rs","name":"1º Reis","chapters":22}, {"abbrev":"2rs","name":"2º Reis","chapters":25},
            {"abbrev":"1cr","name":"1º Crônicas","chapters":29}, {"abbrev":"2cr","name":"2º Crônicas","chapters":36},
            {"abbrev":"ed","name":"Esdras","chapters":10}, {"abbrev":"ne","name":"Neemias","chapters":13},
            {"abbrev":"et","name":"Ester","chapters":10}, {"abbrev":"job","name":"Jó","chapters":42},
            {"abbrev":"sl","name":"Salmos","chapters":150}, {"abbrev":"pv","name":"Provérbios","chapters":31},
            {"abbrev":"ec","name":"Eclesiastes","chapters":12}, {"abbrev":"ct","name":"Cânticos","chapters":8},
            {"abbrev":"is","name":"Isaías","chapters":66}, {"abbrev":"jr","name":"Jeremias","chapters":52},
            {"abbrev":"lm","name":"Lamentações","chapters":5}, {"abbrev":"ez","name":"Ezequiel","chapters":48},
            {"abbrev":"dn","name":"Daniel","chapters":12}, {"abbrev":"os","name":"Oséias","chapters":14},
            {"abbrev":"jl","name":"Joel","chapters":3}, {"abbrev":"am","name":"Amós","chapters":9},
            {"abbrev":"ob","name":"Obadias","chapters":1}, {"abbrev":"jn","name":"Jonas","chapters":4},
            {"abbrev":"mq","name":"Miquéias","chapters":7}, {"abbrev":"na","name":"Naum","chapters":3},
            {"abbrev":"hc","name":"Habacuque","chapters":3}, {"abbrev":"sf","name":"Sofonias","chapters":3},
            {"abbrev":"ag","name":"Ageu","chapters":2}, {"abbrev":"zc","name":"Zacarias","chapters":14},
            {"abbrev":"ml","name":"Malaquias","chapters":4}, {"abbrev":"mt","name":"Mateus","chapters":28},
            {"abbrev":"mc","name":"Marcos","chapters":16}, {"abbrev":"lc","name":"Lucas","chapters":24},
            {"abbrev":"jo","name":"João","chapters":21}, {"abbrev":"at","name":"Atos","chapters":28},
            {"abbrev":"rm","name":"Romanos","chapters":16}, {"abbrev":"1co","name":"1ª Coríntios","chapters":16},
            {"abbrev":"2co","name":"2ª Coríntios","chapters":13}, {"abbrev":"gl","name":"Gálatas","chapters":6},
            {"abbrev":"ef","name":"Efésios","chapters":6}, {"abbrev":"fp","name":"Filipenses","chapters":4},
            {"abbrev":"cl","name":"Colossenses","chapters":4}, {"abbrev":"1ts","name":"1ª Tessalonicenses","chapters":5},
            {"abbrev":"2ts","name":"2ª Tessalonicenses","chapters":3}, {"abbrev":"1tm","name":"1ª Timóteo","chapters":6},
            {"abbrev":"2tm","name":"2ª Timóteo","chapters":4}, {"abbrev":"tt","name":"Tito","chapters":3},
            {"abbrev":"fm","name":"Filemom","chapters":1}, {"abbrev":"hb","name":"Hebreus","chapters":13},
            {"abbrev":"tg","name":"Tiago","chapters":5}, {"abbrev":"1pe","name":"1ª Pedro","chapters":5},
            {"abbrev":"2pe","name":"2ª Pedro","chapters":3}, {"abbrev":"1jo","name":"1ª João","chapters":5},
            {"abbrev":"2jo","name":"2ª João","chapters":1}, {"abbrev":"3jo","name":"3ª João","chapters":1},
            {"abbrev":"jd","name":"Judas","chapters":1}, {"abbrev":"ap","name":"Apocalipse","chapters":22}
        ];

        // Objeto para armazenar os dados da Bíblia que serão carregados
        let bibliaCompleta = {};

        // Função para buscar e armazenar todos os dados da Bíblia
        async function carregarBibliaCompleta() {
            const baseApiUrl = 'https://bibleapi.co/api';
            versiculosContainerEl.innerHTML = '<p>Carregando a Bíblia completa... Isso pode levar um momento.</p>';

            for (const livro of todosOsLivros) {
                bibliaCompleta[livro.abbrev] = {};
                for (let i = 1; i <= livro.chapters; i++) {
                    try {
                        const response = await fetch(`${baseApiUrl}/verses/nvi/${livro.abbrev}/${i}`);
                        if (!response.ok) continue; // Pula se houver erro
                        const data = await response.json();
                        bibliaCompleta[livro.abbrev][i] = data.verses;
                    } catch (error) {
                        console.error(`Falha ao carregar ${livro.name} ${i}`, error);
                    }
                }
            }
            // Após carregar tudo, inicia a exibição
            iniciarExibicao();
        }
        
        function exibirVersiculos(versiculos) {
            versiculosContainerEl.innerHTML = '';
            if (versiculos && Array.isArray(versiculos)) {
                versiculos.forEach(v => {
                    const p = document.createElement('p');
                    p.innerHTML = `<span class="versiculo-numero">${v.number}</span> ${v.text}`;
                    p.className = "mb-3";
                    versiculosContainerEl.appendChild(p);
                });
            } else {
                versiculosContainerEl.innerHTML = '<p class="text-red-600">Dados deste capítulo não disponíveis.</p>';
            }
        }

        function carregarCapitulo(abbrev, capitulo) {
            capituloSelecionadoEl.textContent = `Capítulo ${capitulo}`;
            const versiculos = bibliaCompleta[abbrev] ? bibliaCompleta[abbrev][capitulo] : null;
            if (versiculos) {
                exibirVersiculos(versiculos);
            } else {
                versiculosContainerEl.innerHTML = '<p class="text-red-600">Não foi possível carregar os versículos. A conexão com a internet pode ter falhado durante o carregamento inicial.</p>';
            }
        }

        function iniciarExibicao() {
            const params = new URLSearchParams(window.location.search);
            const abbrev = params.get('abbrev');

            const loadingEl = document.getElementById('loading');
            const conteudoEl = document.getElementById('conteudo-leitura');
            const nomeLivroEl = document.getElementById('nome-livro');
            const seletorCapitulosEl = document.getElementById('seletor-capitulos');

            if (!abbrev) {
                loadingEl.innerHTML = '<p>Nenhum livro selecionado. Volte para a <a href="livros.html" class="underline">lista de livros</a>.</p>';
                return;
            }

            const livroData = todosOsLivros.find(livro => livro.abbrev === abbrev);

            if (livroData) {
                nomeLivroEl.textContent = livroData.name;
                
                seletorCapitulosEl.innerHTML = ''; 
                for (let i = 1; i <= livroData.chapters; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    seletorCapitulosEl.appendChild(option);
                }

                seletorCapitulosEl.addEventListener('change', (e) => {
                    carregarCapitulo(abbrev, e.target.value);
                });

                carregarCapitulo(abbrev, 1);

                loadingEl.style.display = 'none';
                conteudoEl.classList.remove('hidden');
            } else {
                loadingEl.innerHTML = '<p class="text-red-600">Livro não encontrado.</p>';
            }
        }
        
        // Inicia o processo quando a página carrega
        document.addEventListener('DOMContentLoaded', carregarBibliaCompleta);
    </script>
</body>
</html>
